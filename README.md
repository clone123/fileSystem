# fileSystem
文件服务：分片上传，合并，入库，查询，搜索，修改，下载，预览，删除

具体需用到的技术及重点大概如下：

###1：FileReader，前端文件读取，适合做图片预览。

###2：FormDate，slice， Html5新出来的API，对文件的一些处理，切片，传输。

###3：vue-resource , 基于Vue的一个Http请求库，也可自用ajax发送请求数据。

###4：multiparty,formidable 对文件处理的npm包，后续对文件分片接受处理。

###5：Nodejs FS模块，对分片上传上来的文件处理,后面涉及到一系列对文件的操作：

a：文件存盘路径策略

b：提前校验文件的状态，识别，MD5

c：临时文件的读取，转移，重命名
   
###6：最关键的一步，文件的合并，合并策略：

a：前端同步或异步分片上传，后端异步合并————此方法坑颇多，在分片总数较多情况下，异步合并后的文件可能不完整，如压缩文件无法解压，视频播放中出现异常情况。

b：前端同步或异步分片上传，后端同步合并————此方法可行都高，读取文件的方式可以异步，或文件流的形式来读取，控制整体读取逻辑为同步，同步合并文件数据就OK，对后续的断点续传，秒传，也比较好的支持。

###7：入库前，目前基于Mysql, 通过 Sequelize 来对表数据库的增删改查操作。

###8：入库，关于图片，音视频的存储入库策略：

a：直接fileReader获取文件二进制，存储到数据库，缺点是数据量过大，对数据库性能影响很大，Http请数据受限。

b：数据库存只放文件路径，利用 Express 托管静态文件即可，后续删除数据库数据时候，对应文件也需要单独处理删除操作
   
###9：前端数据展示，Vue组件化，需注意的是当然组件里面嵌套一个动态组件，然后通过Vue事件派发不好使，无法监听到。



